
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_TeacherLayout.cshtml";
}



<div style="padding:25px ; width:100%">

    <div class="container">
        <div class="col-lg-6">
            <div class="row" style="margin:0">
                <p style="display:inline-block">رمز این جلسه شما :  </p>
                <p style="display:inline-block">@Session["teacherToken"]</p>

            </div>
            <div class="row" style="padding:15px 0; margin:0;min-height:542px; border: 1px solid #ddd; border-radius:5px; height:100%">

                <ul style="margin-left:30px" id="record-audio"></ul>

            </div>

        </div>
        <div class="col-lg-6" style="padding-top:25px">
            <div class="player_wrapper" style="direction:ltr; padding:0;">
                <div class="player_container">
                    <div id="vod_player" data-native_fullscreen="true" data-ratio="0.555" data-share="false" class="flowplayer" data-logo="https://stream1.ir/wp-content/uploads/live_poster/9e4e341f401b60b3c45bec67481b3084552d3562.png">
                        <video class="livestream" data-title="VOD stream" poster="//player.stream1.ir/images/splash1.png">
                            <source type="application/x-mpegurl" src="http://l.stream1.ir:1935/voddemo/mp4:sample.mp4/playlist.m3u8">
                        </video>
                    </div>
                </div>
            </div>

            @*<script>
                    flowplayer.conf = {
                        fullscreen: true,
                        //iOS allows only native fullscreen from within iframes
                        native_fullscreen: true
                    };

                    (function ($) {
                        var $player = $('.player_container > div');

                        var $window = $(window).resize(function () {
                            var height = ($(this).width() * 9) / 16;
                            if ($(this).height() < height) {
                                height = $(this).height();
                            }
                            var width = (height * 16) / 9;
                            $player.width(width);
                            $player.height(height);
                        }).trigger('resize'); //on page load

                        $(document).ready(function () {
                            $('video').attr('poster', '');
                        });

                    })(jQuery);


                    window.onload = function () {



                        var container = document.getElementById("vod_player"),
                            stream_logo_tag = null;

                        if (container.attributes['data-logo'] !== undefined) {

                            stream_logo_tag = document.createElement('a');
                            stream_logo_tag.classList.add("fp-logo");

                            stream_logo_tag.innerHTML = '<img src="' + container.attributes['data-logo'].value + '">';

                        }

                        setTimeout(function () {

                            if (container.querySelector(".fp-logo") === null && stream_logo_tag !== null) {
                                var ref = container.querySelector('.fp-ui');
                                ref.parentNode.insertBefore(stream_logo_tag, ref.nextSibling);
                            }

                        }, 3000);


                    };


                </script>*@
            <div style="min-height:250px;  border: 1px solid #ddd ; border-radius:5px ; padding:10px; margin-top:5px">

            </div>

        </div>
        <div>

        </div>


    </div>
</div>



@section scripts {

    <link href="~/Content/flowplayer.skin.css" rel="stylesheet" />

    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.4.1.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {

            // Reference the auto-generated proxy for the hub.
            var chat = $.connection.chatHub;
            // Create a function that the hub can call back to display messages.
            chat.client.addNewMessageToPage = function (name, message) {
                // Add the message to the page.
                var html = $('#record-audio').html();
                $('#record-audio').html("<div id='" + name + "' style='padding:10px'><p>" + message + ": </p> <audio class='audiotag'  controls preload='none'><source src='/Files/" + name + ".wav' type='audio/wav'></audio></div> ");
                $('#record-audio').append(html);
                $("#" + name).click(function () {
                    $(this).css("background-color", "#ddd");
                    $(this).css("border", "#fff 1px solid");
                    $(this).css("border-radius", "10px");
                })


            };


            // Start the connection.
            $.connection.hub.start().done(function () {
                var token = '@Session["teacherToken"]';
                chat.server.send("", "", "JG", token);
                $('#sendmessage').click(function () {
                    // Call the Send method on the hub.
                    chat.server.send($('#displayname').val(), $('#message').val());
                    // Clear text box and reset focus for next comment.
                    $('#message').val('').focus();
                });
            });
        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>

    <script src="~/Scripts/flowplayer1.js"></script>
    <script src="~/Scripts/hls.light.min.js"></script>
}

